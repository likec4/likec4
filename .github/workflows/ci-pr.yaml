# CI: reproduce origin repo checks on pull requests and branch pushes.
# Same jobs as main repo (checks.yaml) so PRs get typecheck, build, tests, docs, playground, e2e.
# Only runs on forks (if: github.repository != 'likec4/likec4'); no-op on origin.

name: CI (PR & push)

on:
  pull_request:
    types:
      - opened
      - synchronize
      - reopened
  push:
    branches-ignore:
      - main
      - "changeset-release/*"
      - "releases/*"
    tags-ignore:
      - "**"

concurrency:
  group: ci-${{ github.workflow }}-${{ github.head_ref || github.ref_name }}
  cancel-in-progress: true

jobs:
  checks:
    if: github.repository != 'likec4/likec4' && (github.event_name != 'push' || !contains(github.event.head_commit.message, 'ci skip'))
    uses: ./.github/workflows/checks.yaml
    secrets: inherit
