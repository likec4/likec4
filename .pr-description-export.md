# feat(cli,playground,docs,generators): Export LikeC4 views to Draw.io

## Summary

This PR adds **export** of LikeC4 views to [Draw.io](https://draw.io) (`.drawio`) format. Users can export from the **CLI** (`likec4 export drawio`) and from the **Playground** (right-click on diagram → DrawIO → Export view / Export all). This allows editing diagrams in Draw.io and reusing them in tools that support the format.

**This PR does not include import.** Import from Draw.io will be proposed in a separate PR after this one is merged.

---

## What's in this PR

### 1. Generators (`@likec4/generators`)

- **`packages/generators/src/drawio/generate-drawio.ts`** — Exports a single view or multiple views to Draw.io XML. Maps LikeC4 elements (title, description, shape, color, relationships, etc.) to mxCell vertices/edges. Supports optional `layoutOverride`, `strokeColorByNodeId`, `strokeWidthByNodeId`, `edgeWaypoints`, and `compressed`.
- **`packages/generators/src/drawio/parse-drawio.ts`** — Used only for **round-trip comment parsing** (`parseDrawioRoundtripComments`): when re-exporting after a future import, layout and waypoints from comment blocks in `.c4` source can be applied. No import UI or CLI in this PR.
- **`packages/generators/src/drawio/index.ts`** — Public API: `generateDrawio`, `generateDrawioMulti`, `GenerateDrawioOptions`, plus `getAllDiagrams`, `parseDrawioRoundtripComments`, `parseDrawioToLikeC4`, `parseDrawioToLikeC4Multi` (for roundtrip and for the future import PR).
- **Tests:** `generate-drawio.spec.ts`, `parse-drawio.spec.ts`; snapshots in `__snapshots__/`.

### 2. CLI (`@likec4/likec4`)

- **`packages/likec4/src/cli/export/drawio/handler.ts`** — `likec4 export drawio [path]` with options: `--outdir, -o`, `--all-in-one`, `--roundtrip`, `--uncompressed`, `--project`, `--use-dot`.
- **`packages/likec4/src/cli/export/index.ts`** — Registers the drawio export command.

### 3. Playground

- DrawIO context menu **export only**: DrawioContextMenuProvider, DrawioContextMenuDropdown (Export view…, Export all…), useDrawioContextMenuActions (handleExport, handleExportAllViews; uses generateDrawio/generateDrawioMulti and parseDrawioRoundtripComments). DrawioContextMenu, drawio-events (DRAWIO_EXPORT_EVENT). **No Import item or file input in this PR.**
- Monaco: only **Export to DrawIO** action in editor context menu (no Import action). Integration in LanguageClientSync and routes as needed for export.

Playground exports are **uncompressed** by default so files open reliably in Draw.io desktop.

### 4. Documentation

- **`apps/docs/src/content/docs/tooling/drawio.mdx`** — Export only: mapping (LikeC4 → Draw.io), options, not preserved, multi-diagram, troubleshooting, re-export using comment blocks. No import sections.
- **`apps/docs/src/content/docs/tooling/cli.mdx`** — Export to DrawIO section only; no Import from DrawIO section. Intro mentions Export to DrawIO only.

### 5. Tests

- **`packages/likec4/src/drawio-demo-export-import.spec.ts`** — Export tests only; import/vice-versa test **skipped** in this PR.
- **`packages/likec4/src/drawio-tutorial-export-import.spec.ts`** — Export tests only; import and round-trip tests **skipped** in this PR.
- **`e2e/tests/drawio-playground.spec.ts`** — Asserts DrawIO menu shows **Export to DrawIO** (and Export all). No Import assertion.

---

## What's not in this PR

- No `likec4 import drawio` command (no `packages/likec4/src/cli/import/`).
- No Playground "Import from DrawIO" menu item, file input, or Monaco Import action.
- No docs for importing from Draw.io.
- Import/round-trip tests in likec4 specs are **skipped**; enabled in the import PR.

---

## Checklist (contribution guidelines)

- [ ] I have read the latest [contribution guidelines](https://github.com/likec4/likec4/blob/main/CONTRIBUTING.md).
- [ ] I have rebased my branch onto `main` **before** creating this PR.
- [ ] My commit messages follow [Conventional Commits](https://www.conventionalcommits.org/) (e.g. `feat:`, `docs:`).
- [ ] I have added/updated tests for export; import tests are skipped in this branch.
- [ ] I have run `pnpm test` and `pnpm typecheck` (and `pnpm test:e2e` for e2e); all pass.
- [ ] Documentation updated (drawio.mdx and cli.mdx for **export** only).
- [ ] A changeset has been added for user-facing packages if applicable.

---

## Notes for reviewers

- Export: one `.drawio` file per view by default; `--all-in-one` for all views as tabs; `--roundtrip` applies layout/waypoints from comment blocks; `--uncompressed` for Draw.io desktop compatibility.
- Playground exposes only Export actions in the DrawIO menu.
- Generators: parse-drawio is present for round-trip comments and for the upcoming import PR; no import entrypoints used here.
