{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "id": "LikeC4ProjectConfig",
  "description": "LikeC4 Project Configuration",
  "type": "object",
  "properties": {
    "name": {
      "description": "Project name, must be unique in the workspace",
      "type": "string",
      "minLength": 1
    },
    "extends": {
      "description": "Extend styles from other config files",
      "anyOf": [
        {
          "type": "string",
          "minLength": 1
        },
        {
          "minItems": 1,
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        }
      ]
    },
    "title": {
      "description": "A human readable title for the project",
      "type": "string",
      "minLength": 1
    },
    "contactPerson": {
      "description": "A person who has been involved in creating or maintaining this project",
      "type": "string",
      "minLength": 1
    },
    "styles": {
      "description": "Project styles customization",
      "type": "object",
      "properties": {
        "theme": {
          "description": "Project theme customization",
          "$ref": "#/$defs/ThemeCustomization"
        },
        "defaults": {
          "description": "Override default values for style properties\nThese values will be used if such property is not defined",
          "$ref": "#/$defs/DefaultStyleValues"
        },
        "customCss": {
          "description": "Custom CSS (or list of CSS files) to be included in the generated diagrams",
          "$ref": "#/$defs/CustomStylesheets"
        }
      },
      "additionalProperties": false
    },
    "imageAliases": {
      "$ref": "#/$defs/ImageAliases"
    },
    "include": {
      "$ref": "#/$defs/include-config"
    },
    "exclude": {
      "description": "List of file patterns to exclude from the project, default is [\"**/node_modules/**\"]",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "manualLayouts": {
      "$ref": "#/$defs/ManualLayoutsConfig"
    },
    "federation": {
      "description": "Federation configuration for cross-project model sharing",
      "$ref": "#/$defs/FederationConfig"
    }
  },
  "required": [
    "name"
  ],
  "$defs": {
    "ThemeCustomization": {
      "id": "ThemeCustomization",
      "description": "Customize theme colors and sizes",
      "type": "object",
      "properties": {
        "colors": {
          "description": "Override theme colors",
          "type": "object",
          "propertyNames": {
            "anyOf": [
              {
                "$ref": "#/$defs/ColorName"
              },
              {
                "not": {}
              }
            ]
          },
          "additionalProperties": {
            "$ref": "#/$defs/ThemeColorValues"
          }
        },
        "sizes": {
          "description": "Override theme sizes",
          "type": "object",
          "propertyNames": {
            "anyOf": [
              {
                "$ref": "#/$defs/ElementSize"
              },
              {
                "not": {}
              }
            ]
          },
          "additionalProperties": {
            "$ref": "#/$defs/Dimensions"
          }
        }
      },
      "additionalProperties": false
    },
    "ColorName": {
      "id": "ColorName",
      "anyOf": [
        {
          "$ref": "#/$defs/ThemeColorName"
        },
        {
          "$ref": "#/$defs/CustomColorName"
        }
      ]
    },
    "ThemeColorName": {
      "id": "ThemeColorName",
      "type": "string",
      "enum": [
        "amber",
        "blue",
        "gray",
        "slate",
        "green",
        "indigo",
        "muted",
        "primary",
        "red",
        "secondary",
        "sky"
      ]
    },
    "CustomColorName": {
      "id": "CustomColorName"
    },
    "ThemeColorValues": {
      "id": "ThemeColorValues",
      "description": "Exact value (hex, rgb, rgba, hsl, hsla ...) or break down of specific color values",
      "anyOf": [
        {
          "$ref": "#/$defs/StrictThemeColorValues"
        },
        {
          "$ref": "#/$defs/ColorLiteral"
        }
      ]
    },
    "StrictThemeColorValues": {
      "id": "StrictThemeColorValues",
      "description": "Exact color value (hex, rgb, rgba, hsl, hsla ...) or break down of specific color value",
      "type": "object",
      "properties": {
        "elements": {
          "description": "Exact color value (hex, rgb, rgba, hsl, hsla ...) or break down of specific color values",
          "anyOf": [
            {
              "$ref": "#/$defs/ElementColorValues"
            },
            {
              "$ref": "#/$defs/ColorLiteral"
            }
          ]
        },
        "relationships": {
          "description": "Exact color value (hex, rgb, rgba, hsl, hsla ...) or break down of specific color values",
          "anyOf": [
            {
              "$ref": "#/$defs/RelationshipColorValues"
            },
            {
              "$ref": "#/$defs/ColorLiteral"
            }
          ]
        }
      },
      "required": [
        "elements",
        "relationships"
      ],
      "additionalProperties": false
    },
    "ElementColorValues": {
      "id": "ElementColorValues",
      "type": "object",
      "properties": {
        "fill": {
          "description": "Background color",
          "$ref": "#/$defs/ColorLiteral"
        },
        "stroke": {
          "description": "Stroke color (border, paths above background)",
          "$ref": "#/$defs/ColorLiteral"
        },
        "hiContrast": {
          "description": "High contrast text color (title)",
          "$ref": "#/$defs/ColorLiteral"
        },
        "loContrast": {
          "description": "Low contrast text color (description)",
          "$ref": "#/$defs/ColorLiteral"
        }
      },
      "required": [
        "fill",
        "stroke",
        "hiContrast",
        "loContrast"
      ],
      "additionalProperties": false
    },
    "ColorLiteral": {
      "id": "ColorLiteral",
      "type": "string",
      "minLength": 1
    },
    "RelationshipColorValues": {
      "id": "RelationshipColorValues",
      "type": "object",
      "properties": {
        "line": {
          "description": "Line color",
          "$ref": "#/$defs/ColorLiteral"
        },
        "label": {
          "description": "Label text color",
          "$ref": "#/$defs/ColorLiteral"
        },
        "labelBg": {
          "description": "Label background color",
          "default": "rgba(0, 0, 0, 0.5)",
          "$ref": "#/$defs/ColorLiteral"
        }
      },
      "required": [
        "line",
        "label"
      ],
      "additionalProperties": false
    },
    "ElementSize": {
      "id": "ElementSize",
      "type": "string",
      "enum": [
        "xs",
        "sm",
        "md",
        "lg",
        "xl"
      ]
    },
    "Dimensions": {
      "id": "Dimensions",
      "description": "Defines dimensions for theme size",
      "type": "object",
      "properties": {
        "width": {
          "type": "number",
          "minimum": 50
        },
        "height": {
          "type": "number",
          "minimum": 50
        }
      },
      "required": [
        "width",
        "height"
      ],
      "additionalProperties": false
    },
    "DefaultStyleValues": {
      "id": "DefaultStyleValues",
      "type": "object",
      "properties": {
        "color": {
          "description": "Default color for elements\n(must be a valid color name from the theme)",
          "$ref": "#/$defs/ColorName"
        },
        "opacity": {
          "description": "Default opacity (0-100%) for elements when displayed as a group (like a container)",
          "$ref": "#/$defs/Opacity"
        },
        "border": {
          "description": "Default border style for elements when displayed as a group (like a container)",
          "$ref": "#/$defs/BorderStyle"
        },
        "size": {
          "description": "Default size for elements",
          "$ref": "#/$defs/ElementSize"
        },
        "shape": {
          "description": "Default shape for elements",
          "$ref": "#/$defs/ElementShape"
        },
        "iconPosition": {
          "description": "Default icon position for elements",
          "$ref": "#/$defs/IconPosition"
        },
        "group": {
          "description": "Override default values for group style properties\nThese values will be used if such property is not defined",
          "$ref": "#/$defs/GroupDefaultStyleValues"
        },
        "relationship": {
          "description": "Override default values for relationship style properties\nThese values will be used if such property is not defined",
          "$ref": "#/$defs/RelationshipDefaultStyleValues"
        }
      },
      "additionalProperties": false
    },
    "Opacity": {
      "id": "Opacity",
      "description": "Opacity 0-100%",
      "type": "integer",
      "minimum": 0,
      "maximum": 100
    },
    "BorderStyle": {
      "id": "BorderStyle",
      "type": "string",
      "enum": [
        "solid",
        "dashed",
        "dotted",
        "none"
      ]
    },
    "ElementShape": {
      "id": "ElementShape",
      "type": "string",
      "enum": [
        "rectangle",
        "person",
        "browser",
        "mobile",
        "cylinder",
        "storage",
        "queue",
        "bucket",
        "document"
      ]
    },
    "IconPosition": {
      "id": "IconPosition",
      "type": "string",
      "enum": [
        "left",
        "right",
        "top",
        "bottom"
      ]
    },
    "GroupDefaultStyleValues": {
      "id": "GroupDefaultStyleValues",
      "type": "object",
      "properties": {
        "color": {
          "description": "Default color for groups\n(must be a valid color name from the theme)",
          "$ref": "#/$defs/ColorName"
        },
        "opacity": {
          "description": "Default opacity for groups",
          "$ref": "#/$defs/Opacity"
        },
        "border": {
          "description": "Default border for groups",
          "$ref": "#/$defs/BorderStyle"
        }
      },
      "additionalProperties": false
    },
    "RelationshipDefaultStyleValues": {
      "id": "RelationshipDefaultStyleValues",
      "description": "Override default values for relationship style properties\nThese values will be used if such property is not defined",
      "type": "object",
      "properties": {
        "color": {
          "description": "Default color for relationships\n(must be a valid color name from the theme)",
          "$ref": "#/$defs/ColorName"
        },
        "line": {
          "description": "Default line style for relationships",
          "$ref": "#/$defs/LineType"
        },
        "arrow": {
          "description": "Default arrow style for relationships",
          "$ref": "#/$defs/ArrowType"
        }
      },
      "additionalProperties": false
    },
    "LineType": {
      "id": "LineType",
      "type": "string",
      "enum": [
        "dashed",
        "solid",
        "dotted"
      ]
    },
    "ArrowType": {
      "id": "ArrowType",
      "type": "string",
      "enum": [
        "none",
        "normal",
        "onormal",
        "dot",
        "odot",
        "diamond",
        "odiamond",
        "crow",
        "open",
        "vee"
      ]
    },
    "CustomStylesheets": {
      "id": "CustomStylesheets",
      "anyOf": [
        {
          "type": "string",
          "minLength": 1
        },
        {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        }
      ]
    },
    "ImageAliases": {
      "id": "ImageAliases",
      "description": "Map of image alias prefixes to relative paths (keys must match /^@\\w+$/; values must be relative paths without protocol or leading slash).",
      "type": "object",
      "propertyNames": {
        "type": "string",
        "minLength": 1,
        "pattern": "^@[A-Za-z0-9_-]*$"
      },
      "additionalProperties": {
        "type": "string",
        "minLength": 1,
        "pattern": "^(?!\\/|[A-Za-z]:[\\\\\\/])(?!.*:\\/\\/).*$"
      }
    },
    "include-config": {
      "id": "include-config",
      "description": "Configuration for including additional LikeC4 source files from other directories.\nExample: { \"paths\": [\"../shared\", \"../common/specs\"], \"maxDepth\": 5, \"fileThreshold\": 50 }",
      "type": "object",
      "properties": {
        "paths": {
          "description": "Additional relative directory paths to include LikeC4 source files from, searched recursively.\nPaths are relative to the project folder (the folder containing this config file).\nExample: [\"../shared\", \"../common/specs\"]",
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1,
            "pattern": "^(?!\\/|[A-Za-z]:[\\\\\\/])(?!.*:\\/\\/).*$"
          }
        },
        "maxDepth": {
          "description": "Maximum directory depth to scan when searching for .c4 files in include paths.\nPrevents excessive scanning of deeply nested directories.\nDefault: 3",
          "default": 3,
          "type": "integer",
          "minimum": 1,
          "maximum": 20
        },
        "fileThreshold": {
          "description": "Maximum number of files to load from include paths before warning.\nHelps identify performance issues from accidentally including large directories.\nDefault: 30",
          "default": 30,
          "type": "integer",
          "minimum": 1,
          "maximum": 10000
        }
      },
      "required": [
        "paths"
      ],
      "additionalProperties": false
    },
    "ManualLayoutsConfig": {
      "id": "ManualLayoutsConfig",
      "description": "Configuration for manual layouts",
      "type": "object",
      "properties": {
        "outDir": {
          "description": "Path to the directory where manual layouts will be stored,\nrelative to the folder containing the project config. \n\nDefaults to '.likec4'.",
          "default": ".likec4",
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "FederationConfig": {
      "id": "FederationConfig",
      "description": "Federation configuration for cross-project model sharing",
      "type": "object",
      "properties": {
        "exports": {
          "description": "FQN patterns of elements to export, e.g. [\"authService\", \"authService.api\"]",
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "exportViews": {
          "description": "View IDs to export, e.g. [\"authServiceOverview\"]",
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "dependencies": {
          "description": "Dependencies on other projects' published manifests",
          "type": "object",
          "propertyNames": {
            "type": "string"
          },
          "additionalProperties": {
            "type": "object",
            "properties": {
              "source": {
                "description": "Path to manifest directory (local directory or git repo)",
                "type": "string",
                "minLength": 1
              },
              "version": {
                "description": "Semver version range, e.g. \"^1.0.0\". Omit for Apollo-style (always latest)",
                "type": "string",
                "minLength": 1
              }
            },
            "required": [
              "source"
            ],
            "additionalProperties": false
          }
        },
        "publish": {
          "description": "Configuration for publishing this project's manifest",
          "type": "object",
          "properties": {
            "outDir": {
              "description": "Output directory for published manifests, relative to project root",
              "default": ".likec4/federation",
              "type": "string"
            },
            "registryDir": {
              "description": "Path to the Apollo-style registry directory containing registry.json",
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      }
    }
  }
}